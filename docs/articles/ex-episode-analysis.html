<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Episode analysis • rtrek</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Episode analysis">
<meta property="og:description" content="">
<meta property="og:image" content="https://leonawicz.github.io/rtrek/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-46129458-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-46129458-3');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rtrek</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/rtrek.html">Get Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stapi.html">Star Trek API (STAPI)</a>
    </li>
    <li>
      <a href="../articles/memory-alpha.html">Memory Alpha</a>
    </li>
    <li>
      <a href="../articles/memory-beta.html">Memory Beta</a>
    </li>
    <li>
      <a href="../articles/fonts.html">Star Trek fonts</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Examples</li>
    <li>
      <a href="../articles/ex-word-count.html">Novels: word count</a>
    </li>
    <li>
      <a href="../articles/ex-episode-analysis.html">Episodes: spoken lines</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/sc.html">Stellar Cartography</a>
</li>
<li>
  <a href="../articles/rr.html">R &amp; R... &amp; R</a>
</li>
<li>
  <a href="https://github.com/leonawicz/rtrek">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Episode analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leonawicz/rtrek/blob/master/vignettes/ex-episode-analysis.Rmd"><code>vignettes/ex-episode-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>ex-episode-analysis.Rmd</code></div>

    </div>

    
    
<p>A curated data frame of metadata and text variables derived from episode and movie transcripts can be downloaded with <code>st_transcripts</code>. The format is one episode per row. There are metadata columns and list column of nested text variables.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggrepel)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">(scriptData &lt;-<span class="st"> </span><span class="kw"><a href="../reference/st_transcripts.html">st_transcripts</a></span>())</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; # A tibble: 726 x 10</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt;    format  series season number title  production airdate url   url2  text </span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;lis&gt;</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt;  1 episode TOS         1      0 The C~          1 &lt;NA&gt;    http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;  2 episode TOS         1      1 The M~          6 1966-0~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt;  3 episode TOS         1      2 Charl~          8 1966-0~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt;  4 episode TOS         1      3 Where~          2 1966-0~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt;  5 episode TOS         1      4 The N~          7 1966-0~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt;  6 episode TOS         1      5 The E~          5 1966-1~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">#&gt;  7 episode TOS         1      6 Mudd'~          4 1966-1~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">#&gt;  8 episode TOS         1      7 What ~         10 1966-1~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">#&gt;  9 episode TOS         1      8 Miri           12 1966-1~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co">#&gt; 10 episode TOS         1      9 Dagge~         11 1966-1~ http~ http~ &lt;tib~</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co">#&gt; # ... with 716 more rows</span></a>
<a class="sourceLine" id="cb1-21" title="21"></a>
<a class="sourceLine" id="cb1-22" title="22">scriptData<span class="op">$</span>text[[<span class="dv">81</span>]]</a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co">#&gt; # A tibble: 816 x 6</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">#&gt;    line_number perspective   setting       description character line      </span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co">#&gt;          &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     </span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">#&gt;  1          NA &lt;NA&gt;          Fade in       &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;      </span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">#&gt;  2           1 Ext. Space -~ The u.s.s. E~ &lt;NA&gt;        Picard V~ Captain's~</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">#&gt;  3           2 Other introd~ On the gigan~ &lt;NA&gt;        Picard V~ My orders~</span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co">#&gt;  4           3 Int. Engine ~ Huge, with a~ Continuing  Picard V~ ... I am ~</span></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="co">#&gt;  5           4 Closer on ve~ Showing the ~ &lt;NA&gt;        Picard V~ I am stil~</span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="co">#&gt;  6          NA Int. Lounge ~ With its hug~ &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;      </span></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">#&gt;  7           5 Continued     &lt;NA&gt;          Continuing  Picard V~ ... my cr~</span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="co">#&gt;  8           6 Int. Bridge ~ "Picard, tro~ Continuing  Picard V~ ... a fir~</span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="co">#&gt;  9           7 Angle emphas~ As picard tu~ &lt;NA&gt;        Picard    You will ~</span></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="co">#&gt; 10           8 Angle emphas~ &lt;NA&gt;          &lt;NA&gt;        Data      Difficult~</span></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="co">#&gt; # ... with 806 more rows</span></a></code></pre></div>
<p>Consider TNG episodes. A rough estimate of the relative amount of speaking parts can be obtained by counting up the lines for each character. A better measure would be an estimate of word count taken from each spoken line. Calculate these statistics by season and episode as well as character.</p>
<p>Also remove unneeded columns. As is common in text analysis, even a clean dataset may need further preparation for a specific task. In this case it is important to strip references to things such as voiceover <code>(V.o.)</code> from the <code>character</code> column.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">pat &lt;-<span class="st"> "('s</span><span class="ch">\\</span><span class="st">s|</span><span class="ch">\\</span><span class="st">s</span><span class="ch">\\</span><span class="st">(|</span><span class="ch">\\</span><span class="st">sV</span><span class="ch">\\</span><span class="st">.).*"</span></a>
<a class="sourceLine" id="cb2-2" title="2">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(scriptData, format <span class="op">==</span><span class="st"> "episode"</span> <span class="op">&amp;</span><span class="st"> </span>series <span class="op">==</span><span class="st"> "TNG"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">  </span><span class="kw">unnest</span>(text) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="st">  </span><span class="kw">select</span>(season, title, character, line) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">character =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">gsub</a></span>(pat, <span class="st">""</span>, character)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(season, title, character) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">lines =</span> <span class="kw">n</span>(), <span class="dt">words =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/strsplit">strsplit</a></span>(line, <span class="st">" "</span>))))</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9">x</a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; # A tibble: 2,858 x 5</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; # Groups:   season, title [176]</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt;    season title    character        lines words</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt;     &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt;  1      1 11001001 &lt;NA&gt;                30    30</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt;  2      1 11001001 Ad Libbed Voices     1    14</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt;  3      1 11001001 Bass                 4    16</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt;  4      1 11001001 Beverly              7   169</span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#&gt;  5      1 11001001 Bynar One Zero       1     5</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co">#&gt;  6      1 11001001 Bynar Zero One       1     9</span></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co">#&gt;  7      1 11001001 Computer            11    96</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="co">#&gt;  8      1 11001001 Computer Voice      14   129</span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co">#&gt;  9      1 11001001 Data                31   361</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co">#&gt; 10      1 11001001 Drummer              2    22</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co">#&gt; # ... with 2,848 more rows</span></a></code></pre></div>
<p>Focus on the top eight characters.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">totals &lt;-<span class="st"> </span><span class="kw">group_by</span>(x, character) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">lines =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(lines), <span class="dt">words =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(words)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(words)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5">totals</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; # A tibble: 8 x 3</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt;   character lines  words</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt;   &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; 1 Picard    14126 163701</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; 2 Data       7012  88573</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; 3 Riker      8284  78207</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; 4 Geordi     5095  57868</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt; 5 Beverly    3740  45114</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; 6 Troi       3615  39128</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; 7 Worf       4233  36345</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; 8 Wesley     1564  14164</span></a></code></pre></div>
<p>By the way, look at the total estimated lines and words spoken by each character. These are of course rough estimates. Nevertheless, it is interesting to see that Picard has nearly twice as much to say as the next most talkative character on the show, the Android, Data. It must be all those impromptu diplomatic speeches.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">id &lt;-<span class="st"> </span>totals<span class="op">$</span>character</a>
<a class="sourceLine" id="cb4-2" title="2">chr &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(totals<span class="op">$</span>character, <span class="dt">levels =</span> id)</a>
<a class="sourceLine" id="cb4-3" title="3">uniform_colors &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"#a71313"</span>, <span class="st">"#c1c730"</span>, <span class="st">"#2b53a7"</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">ulev &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Command"</span>, <span class="st">"Operations"</span>, <span class="st">"Science"</span>)</a>
<a class="sourceLine" id="cb4-5" title="5">uniform &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(ulev[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>)], <span class="dt">levels =</span> ulev)</a>
<a class="sourceLine" id="cb4-6" title="6">totals &lt;-<span class="st"> </span><span class="kw">mutate</span>(totals, <span class="dt">character =</span> chr, <span class="dt">uniform =</span> uniform)</a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="kw">ggplot</span>(totals, <span class="kw">aes</span>(character, words, <span class="dt">fill =</span> uniform)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">color =</span> <span class="ot">NA</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> uniform_colors) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(words <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>), <span class="st">"K"</span>)), </a>
<a class="sourceLine" id="cb4-12" title="12">            <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">vjust =</span> <span class="fl">1.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dv">18</span>)</a></code></pre></div>
<p><img src="ex-episode-analysis_files/figure-html/ep4-1.png" width="1152"></p>
<p>What is each character’s biggest episode per season in terms of estimated spoken words?</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">biggest &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(x, character <span class="op">%in%</span><span class="st"> </span>id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">character =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(character, <span class="dt">levels =</span> id)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(season, character) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">title =</span> title[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.max</a></span>(words)], <span class="dt">words =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(words)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(character)</a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7">biggest</a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; # A tibble: 55 x 4</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; # Groups:   season [7]</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt;    season character title                 words</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt;     &lt;int&gt; &lt;fct&gt;     &lt;chr&gt;                 &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt;  1      1 Picard    Encounter at Farpoint  2575</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt;  2      2 Picard    The Measure of a Man   1844</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt;  3      3 Picard    The Survivors          1738</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt;  4      4 Picard    Devil's Due            2095</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt;  5      5 Picard    Ensign Ro              1897</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt;  6      6 Picard    The Chase              2083</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt;  7      7 Picard    All Good Things...     4019</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt;  8      1 Data      Datalore                944</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt;  9      2 Data      The Schizoid Man       1592</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt; 10      3 Data      The Offspring          1886</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; # ... with 45 more rows</span></a>
<a class="sourceLine" id="cb5-23" title="23"></a>
<a class="sourceLine" id="cb5-24" title="24">biggest &lt;-<span class="st"> </span><span class="kw">mutate</span>(biggest, <span class="dt">winner =</span> character[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.max</a></span>(words)],</a>
<a class="sourceLine" id="cb5-25" title="25">                  <span class="dt">ymn =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(words), <span class="dt">ymx =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(words)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">uniform =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(uniform[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/match">match</a></span>(biggest<span class="op">$</span>character, id)], <span class="dt">levels =</span> ulev))</a>
<a class="sourceLine" id="cb5-27" title="27"></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="kw">ggplot</span>(biggest, <span class="kw">aes</span>(season, words)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> ymn, <span class="dt">ymax =</span> ymx)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> uniform), <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> uniform_colors) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(title, <span class="st">" ("</span>, character, <span class="st">")"</span>)), </a>
<a class="sourceLine" id="cb5-33" title="33">                  <span class="dt">size =</span> <span class="fl">2.3</span>, <span class="dt">hjust =</span> <span class="fl">-0.1</span>, <span class="dt">direction =</span> <span class="st">"y"</span>, <span class="dt">min.segment.length =</span> <span class="fl">0.65</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">labels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">expand =</span> <span class="kw">expand_scale</span>(<span class="dv">0</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="ex-episode-analysis_files/figure-html/ep5-1.png" width="1152"></p>
<p>Finally, look at both Worf and O’Brien, making a comparison between TNG and DS9 in terms of their prominence.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(scriptData, format <span class="op">==</span><span class="st"> "episode"</span> <span class="op">&amp;</span><span class="st"> </span>series <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TNG"</span>, <span class="st">"DS9"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw">unnest</span>(text) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw">select</span>(series, season, title, character, line) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">character =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">gsub</a></span>(pat, <span class="st">""</span>, character)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(character <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Worf"</span>, <span class="st">"O'brien"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(series, title, character) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">lines =</span> <span class="kw">n</span>(), <span class="dt">words =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/strsplit">strsplit</a></span>(line, <span class="st">" "</span>))))</a>
<a class="sourceLine" id="cb6-8" title="8"></a>
<a class="sourceLine" id="cb6-9" title="9">avg &lt;-<span class="st"> </span><span class="kw">group_by</span>(x, series, character) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">lines =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(lines), <span class="dt">words =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(words)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="st">  </span><span class="kw">arrange</span>(character, series) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb6-12" title="12">avg<span class="op">$</span>character &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">gsub</a></span>(<span class="st">"O'brien"</span>, <span class="st">"O'Brien"</span>, avg<span class="op">$</span>character)</a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14">avg</a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; # A tibble: 4 x 4</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt;   series character lines words</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; 1 DS9    O'Brien    34.5  364.</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; 2 TNG    O'Brien    11.6  117.</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; 3 DS9    Worf       22.2  227.</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt; 4 TNG    Worf       24.2  208.</span></a>
<a class="sourceLine" id="cb6-22" title="22"></a>
<a class="sourceLine" id="cb6-23" title="23">id &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(avg<span class="op">$</span>character))</a>
<a class="sourceLine" id="cb6-24" title="24">chr &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(avg<span class="op">$</span>character, <span class="dt">levels =</span> id)</a>
<a class="sourceLine" id="cb6-25" title="25">avg &lt;-<span class="st"> </span><span class="kw">mutate</span>(avg, <span class="dt">series =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(series, <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TNG"</span>, <span class="st">"DS9"</span>)), <span class="dt">character =</span> chr)</a>
<a class="sourceLine" id="cb6-26" title="26"></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="kw">ggplot</span>(avg, <span class="kw">aes</span>(character, words, <span class="dt">fill =</span> series)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">color =</span> <span class="ot">NA</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-29" title="29"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"dodgerblue"</span>, <span class="st">"orange"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(series, <span class="st">": "</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(words))), </a>
<a class="sourceLine" id="cb6-31" title="31">            <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">vjust =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb6-32" title="32">            <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-33" title="33"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Average words per episode"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dv">18</span>)</a></code></pre></div>
<p><img src="ex-episode-analysis_files/figure-html/ep6-1.png" width="1152"></p>
<p>Starfleet promotions in rank aside, Worf did not even quite receive a 10% pay bump in terms of average spoken words per episode. On the other hand, O’Brien had an increase of 211%, or more than triple the average number of spoken words per episode when moving from the Enterprise to Deep Space Nine. All things considered, take the transfer. But on spoken words alone, O’Brien was clearly favored. The squeaky wheel gets the grease.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://leonawicz.github.io/">Matthew Leonawicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
